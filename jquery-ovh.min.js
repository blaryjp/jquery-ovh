/*! jquery-ovh v0.0.0 by Jean-Philippe Blary (@blary_jp) - https://github.com/blaryjp/jquery-ovh - License MIT */
!function(a){"use strict";if("function"==typeof define&&define.amd)define(["jquery"],a);else if("object"==typeof exports)a(require("jquery"));else{var b=window.jQuery||window.Zepto||window.ender||window.$;b.ovh=a(b)}}(function(a){"use strict";function b(a){r=a}function c(a){t.ak=a}function d(a){t.as=a}function e(a){t.ck=a,localStorage.setItem("ovh-ck",a)}function f(a){s=a}function g(b){return l()&&(localStorage.removeItem("ovh-ck"),t.ck=null),a.ajax({type:"POST",url:r+"/auth/credential",headers:a.extend({"X-Ovh-Application":t.ak},o()),processData:!1,data:JSON.stringify({accessRules:s,redirection:b||window.location.href})})[v](function(a){return t.ck=a.consumerKey,localStorage.setItem("ovh-ck",t.ck),window.location=a.validationUrl,a})}function h(){return l()?m()[v](function(b){return a.ajax({type:"POST",url:r+"/auth/logout",headers:o({method:"POST",url:r+"/auth/logout",body:"",diff:b})})[v](function(){localStorage.removeItem("ovh-ck"),t.ck=null},function(a){return localStorage.removeItem("ovh-ck"),t.ck=null,a})},function(a){return a}):p()}function i(b){return l()||b.noAuthentication?m()[v](function(c){var d=b.params;return b.params&&~b.url.indexOf("{")&&(d=a.extend({},b.params),a.each(d,function(a,c){new RegExp("{"+a+"}").test(b.url)&&(b.url=b.url.replace("{"+a+"}",encodeURIComponent(c)),delete d[a])})),b.params=d,b.headers=b.noAuthentication?o():o({method:b.type,url:b.url,body:b.data?JSON.stringify(b.data):"",diff:c}),b.data&&(b.processData=!1,b.data=JSON.stringify(b.data)),a.ajax(b)}):p()}function j(b){return a.ajax({type:"GET",url:r+b+".json",cache:!0,headers:o()})}function k(a,b){return j(a)[v](function(a){return b?a.models[b]:a.models})}function l(){return!!t.ck}function m(){return a.ajax({type:"GET",url:r+"/auth/time",cache:!0,headers:o()})[v](function(a){return Math.floor(Date.now()/1e3)-a})}function n(a){return"$1$"+q([t.as,t.ck,a.method,a.url,a.body,a.diff].join("+"))}function o(a){if(a){var b=(Math.floor(Date.now()/1e3)-a.diff).toString();return{"Content-Type":"application/json;charset=UTF-8","X-Ovh-Application":t.ak,"X-Ovh-Consumer":t.ck,"X-Ovh-Timestamp":b,"X-Ovh-Signature":n({method:a.method,url:a.url,body:a.body,diff:b})}}return{"Content-Type":"application/json;charset=UTF-8"}}function p(){var b={errorCode:"NOT_CREDENTIAL",message:"This credential does not exist"};return a.Deferred().reject({responseJSON:b,responseText:JSON.stringify(b),status:403,statusText:"Forbidden"},"error","Bad Request").promise()}function q(a){function b(a,b){var c=a<<b|a>>>32-b;return c}function c(a){var b,c,d="";for(b=7;b>=0;b--)c=a>>>4*b&15,d+=c.toString(16);return d}function d(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b}var e,f,g,h,i,j,k,l,m,n=new Array(80),o=1732584193,p=4023233417,q=2562383102,r=271733878,s=3285377520;a=d(a);var t=a.length,u=new Array;for(f=0;t-3>f;f+=4)g=a.charCodeAt(f)<<24|a.charCodeAt(f+1)<<16|a.charCodeAt(f+2)<<8|a.charCodeAt(f+3),u.push(g);switch(t%4){case 0:f=2147483648;break;case 1:f=a.charCodeAt(t-1)<<24|8388608;break;case 2:f=a.charCodeAt(t-2)<<24|a.charCodeAt(t-1)<<16|32768;break;case 3:f=a.charCodeAt(t-3)<<24|a.charCodeAt(t-2)<<16|a.charCodeAt(t-1)<<8|128}for(u.push(f);u.length%16!=14;)u.push(0);for(u.push(t>>>29),u.push(t<<3&4294967295),e=0;e<u.length;e+=16){for(f=0;16>f;f++)n[f]=u[e+f];for(f=16;79>=f;f++)n[f]=b(n[f-3]^n[f-8]^n[f-14]^n[f-16],1);for(h=o,i=p,j=q,k=r,l=s,f=0;19>=f;f++)m=b(h,5)+(i&j|~i&k)+l+n[f]+1518500249&4294967295,l=k,k=j,j=b(i,30),i=h,h=m;for(f=20;39>=f;f++)m=b(h,5)+(i^j^k)+l+n[f]+1859775393&4294967295,l=k,k=j,j=b(i,30),i=h,h=m;for(f=40;59>=f;f++)m=b(h,5)+(i&j|i&k|j&k)+l+n[f]+2400959708&4294967295,l=k,k=j,j=b(i,30),i=h,h=m;for(f=60;79>=f;f++)m=b(h,5)+(i^j^k)+l+n[f]+3395469782&4294967295,l=k,k=j,j=b(i,30),i=h,h=m;o=o+h&4294967295,p=p+i&4294967295,q=q+j&4294967295,r=r+k&4294967295,s=s+l&4294967295}var m=c(o)+c(p)+c(q)+c(r)+c(s);return m.toLowerCase()}var r="https://api.ovh.com/1.0",s=[{method:"GET",path:"/*"},{method:"POST",path:"/*"},{method:"PUT",path:"/*"},{method:"DELETE",path:"/*"}],t={ak:"",as:"",ck:""},u=a.fn.jquery&&a.fn.jquery.split("."),v=u&&1===parseInt(u[0],10)&&parseInt(u[1],10)<8?"pipe":"then";t.ck=localStorage.getItem("ovh-ck");var w={setBaseUrl:b,setAppKey:c,setAppSecret:d,setConsumerKey:e,setAccessRules:f,login:g,logout:h,isLogged:l,getSchema:j,getModels:k};return a.each(["get","put","post","delete","remove","del"],function(b,c){w[c]=function(b,d){return i(a.extend(d||{},{type:("remove"===c||"del"===c?"delete":c).toUpperCase(),url:r+b}))}}),w});